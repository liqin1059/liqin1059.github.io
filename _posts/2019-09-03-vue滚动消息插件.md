---
layout: post
title: vueæ»šåŠ¨æ¶ˆæ¯æ’ä»¶
date: 2019-09-03 16:31:30
categories: vue
tags: [vueæ’ä»¶]
---

è‡ªå·±å°è£…äº†ä¸€ä¸ªvueæ»šåŠ¨æ¶ˆæ¯æ’ä»¶:bowtie:ï¼Œä¹‹å‰åœ¨æŸ¥æ‰¾çš„èµ„æ–™åŸºæœ¬éƒ½æ˜¯åŸºäºjqueryçš„ï¼ŒåŸºäºdomçš„ï¼Œè‡ªå·±ç¼–å†™ä¸€æ¬¾æ— ä¾èµ–ï¼Œä¸åŸºäºdomæ“ä½œå¾—æ¶ˆæ¯æ»šåŠ¨æ’ä»¶ï¼Œ
ä¸»è¦å®ç°æ€è·¯æ˜¯ä¸¤ä¸ªulçš„æ‹¼æ¥å’Œè¿æ¥ã€æ›´æ–°ï¼Œé¿å…äº†æ•°ç»„æ›´æ–°æ—¶çš„é—ªå±é—®é¢˜å’Œæ»šåŠ¨åŠ¨ç”»æ•ˆæœæ›´å®Œç¾:trollface:ã€‚

<!-- more -->

## æ¨¡æ¿
``` html
<div class="roll-msg-box"
      :style="{'height': rollHeight}">
  <div ref="rollmsgul"
        class="roll-msg-limit-box"
        :style="[{marginTop: -(ulMarginTop) + 'px'}]">
    <ul class="roll-msg"
        v-for="(item, index) in rollData"
        :key="index">
      <li v-for="(items, indexs) in item"
          :key="indexs"
          :style="[liStyle]">
        <span v-if="!slotShow">{{ items }}</span>
        <slot v-else :item="items"></slot>
      </li>
    </ul>
  </div>
  </div>
```
## åˆå§‹åŒ–ä¸¤æ¡ulæ•°æ®

``` javascript
created() {
  this.$data.rollData = [this.listData, this.listData];
}
```

## æ»šåŠ¨æ–¹æ³•

``` javascript
ScrollUp() {
  let _this = this;
  // console.log('æ‰§è¡Œæ–¹æ³•');
  this.$nextTick(() => {
    // å¼‚æ­¥è·å–æ•°æ®é«˜åº¦é—®é¢˜
    _this.$data.offsetHeight = _this.$refs.rollmsgul.offsetHeight;
    // console.log(_this.$refs.rollmsgul.offsetHeight);
    _this.$data.rollDataLength = _this.$data.rollData[0].length * _this.$data.rollData.length || 1;
  });
  // console.log(this.intNum);
  this.intNum = setInterval(() => {
    // æ¯éš”ä¸€ä¸ªliåœé¡¿ä¸€ä¸‹
    if (_this.$data.ulMarginTop % (_this.$data.offsetHeight/_this.$data.rollDataLength) === 0) {
      // console.log(_this.$data.ulMarginTop + 'ulMarginTop');
      // console.log(_this.$data.offsetHeight + '_this.$data.offsetHeight');
      // console.log(_this.$data.rollDataLength + '_this.$data.rollDataLength');
      // console.log(_this.$data.offsetHeight/_this.$data.rollDataLength + 'æ¯æ®µ');
      // console.log(_this.$data.rollData);
      _this.$data.rollHeight = _this.$data.offsetHeight/_this.$data.rollDataLength + 'px';
      // console.log(_this.$data.rollHeight);
      clearInterval(_this.intNum);
      _this.intTimeOut = setTimeout(() => {
        _this.ScrollUp();
        _this.$data.ulMarginTop++;
      }, _this.rollTime);
    }
    // å¾ªç¯ul
    if (_this.$data.ulMarginTop === _this.$data.offsetHeight) {
      _this.$data.ulMarginTop = 0;
    } else if (_this.$data.ulMarginTop === (_this.$data.offsetHeight / 2  + _this.$data.offsetHeight / _this.$data.rollDataLength)) {
    // å¾ªç¯ul åˆ°è¾¾ç¬¬äºŒä¸ªåˆ—è¡¨çš„ç¬¬ä¸€ä¸ªç»“æŸæ—¶ æŠŠç¬¬ä¸€ä¸ªåˆ—è¡¨æ‹¼æ¥åˆ°ç¬¬äºŒä¸ªåé¢
      _this.rollData.push(_this.rollData[0]);
      _this.rollData.shift();
      // æ›´æ–°å½“å‰å¤–å±‚ç›’å­çš„marigntop å¦åˆ™ä¼šå°†æ•´ä¸ªåˆ—è¡¨æ›¿æ¢åˆ°ä¹‹å‰çš„ä½ç½®
      _this.$data.ulMarginTop = _this.$data.offsetHeight / _this.$data.rollDataLength;
      _this.$data.ulMarginTop++;
    } else {
      _this.$data.ulMarginTop++;
    }
  }, 20);
}
```
## å¼‚æ­¥æ›´æ–°

``` javascript
watch: {
  // å¦‚æœæ•°æ®æ˜¯ä»åç«¯æ‹‰å–å›æ¥å¼‚æ­¥æ›´æ–°çš„
  listData(val) {
    this.$data.rollData = [val, val]; // åˆå§‹åŒ–ä¸¤æ¡ulæ•°æ®
    if (this.intNum) {
      clearInterval(this.intNum);
    }
    this.ScrollUp();
  }
}
```
## äº‹ä»¶æ¸…é™¤

``` javascript
beforeDestroy() {
  if (this.intTimeOut) {
    clearTimeout(this.intTimeOut);
  }
  if (this.intNum) {
    clearInterval(this.intNum);
  }
}
```

## æ’ä»¶ä½¿ç”¨è¯´æ˜:yum:

### vue-news-scroll
[![NPM version](https://img.shields.io/npm/v/vue-news-scroll.svg)](https://www.npmjs.com/package/vue-news-scroll)

-  vue æ»šåŠ¨æ¶ˆæ¯æ’ä»¶ğŸ‘«
-  æ»šåŠ¨æ ·å¼
-  æ»šåŠ¨æ—¶é—´é—´éš”
-  æ»šåŠ¨è‡ªå®šä¹‰æ’æ§½
-  æ”¯æŒå¼‚æ­¥è·å–æ»šåŠ¨æ•°æ®

### npm

``` bash

# npm install
npm install vue-news-scroll --save

```
### å¼•å…¥

åœ¨main.jsä¸­å¼•å…¥

```js
import vueNewsScroll from 'vue-news-scroll'
Vue.use(vueNewsScroll)
```

### ä½¿ç”¨

####  æ»šåŠ¨æ¶ˆæ¯

``` html
<vue-news-scroll
  :list-data="listData"
  :li-style="liStyle"
  :rollTime="1600">
</vue-news-scroll>
```

| å‚æ•° | ç±»å‹ | å¤‡æ³¨ | é»˜è®¤å€¼ |
|  ------ | ------ | ------ | ------ |
| listData | Array | å¾ªç¯æ•°æ® | [] |
| liStyle | Object | å¾ªç¯æ•°æ®æ ·å¼<br>ï¼ˆé©¼å³°å‘½åï¼šbackgroundColorï¼‰ | {} |
| rollTime | Number | å¾ªç¯æ•°æ®åœé¡¿æ—¶é—´ | 2000 |
| slotShow | Boolean | æ˜¯å¦ä½¿ç”¨è‡ªå®šä¹‰æ’æ§½ | false |

###  ä½¿ç”¨è‡ªå®šä¹‰æ’æ§½

- è®¾ç½®å±æ€§slotShowä¸ºtrue

``` html
<vue-news-scroll
  :list-data="listData"
  :li-style="liStyle"
  :slot-show="true"
  :rollTime="1600">
  <template slot-scope="scope">
    <div style="position:relative;">
      {{ scope.item.phone }}
      æˆåŠŸä¸‹å•
      {{ scope.item.money }}å…ƒ
      <span style="position:absolute;right:0;">
        {{ scope.item.time }}
      </span>
    </div>
  </template>
</vue-news-scroll>
```

å±æ€§ä¸¾ä¾‹

```
listData: [
  { money: '14000', name: 'è®¸å°å§', phone: '157****7192', time: '1åˆ†é’Ÿå‰' },
  { money: '5000', name: 'å·¢å…ˆç”Ÿ', phone: '136****6246', time: '2åˆ†é’Ÿå‰' }
]
```

```
liStyle: {
  backgroundColor: '#FFFFFF',
  color: '#C79446',
  fontSize: '14px',
  padding: '10px', // æœ€å¥½è®¾ç½®ä¸€ç‚¹padding
  paddingLeft: '40px',
  paddingRight: '40px'
}
```

### æ•ˆæœå±•ç¤º

å½•åˆ¶gifå‡ºæ¥æ•ˆæœæœ‰ç‚¹å¡é¡¿ï¼Œå®é™…æ²¡æœ‰ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆ

<center><img src="../assets/img/rollmsggif.gif"></center><br/>


æºç åœ°å€ï¼š[https://github.com/liqin1059/vue-news-scroll](https://github.com/liqin1059/vue-news-scroll)
:partly_sunny: